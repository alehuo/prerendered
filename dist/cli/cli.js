#!/usr/bin/env node
(function e(r,o){if(typeof exports==="object"&&typeof module==="object")module.exports=o();else if(typeof define==="function"&&define.amd)define("prerendered_cli",[],o);else if(typeof exports==="object")exports["prerendered_cli"]=o();else r["prerendered_cli"]=o()})(this,(function(){return function(e){var r={};function o(n){if(r[n]){return r[n].exports}var t=r[n]={i:n,l:false,exports:{}};e[n].call(t.exports,t,t.exports,o);t.l=true;return t.exports}o.m=e;o.c=r;o.d=function(e,r,n){if(!o.o(e,r)){Object.defineProperty(e,r,{enumerable:true,get:n})}};o.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};o.t=function(e,r){if(r&1)e=o(e);if(r&8)return e;if(r&4&&typeof e==="object"&&e&&e.__esModule)return e;var n=Object.create(null);o.r(n);Object.defineProperty(n,"default",{enumerable:true,value:e});if(r&2&&typeof e!="string")for(var t in e)o.d(n,t,function(r){return e[r]}.bind(null,t));return n};o.n=function(e){var r=e&&e.__esModule?function r(){return e["default"]}:function r(){return e};o.d(r,"a",r);return r};o.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)};o.p="";return o(o.s=1)}([function(e,r){e.exports=require("path")},function(e,r,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:true});var t=n(o(2));var i=n(o(0));var s=n(o(3));var a=n(o(4));var u=o(5);var l=o(6);u.program.version("0.0.1");u.program.option("--debug, -d","Enable debug printing");u.program.command("init").description("Initialize prerendered").action((function(e,r){if(t.default.existsSync(i.default.join(process.cwd(),"prerendered.json"))){throw new Error("Error! prerendered.json already exists. Please delete it before proceeding.")}console.log("Thank you for using prerendered. I will now ask a few questions about your app.");console.log("A configuration file will be created to the project root which is used by the build command.");console.log("The folder I will use as a base will be "+process.cwd());var o=[{type:"input",name:"entrypoint",message:"What is your client entrypoint? (Current working dir: "+process.cwd()+")"}];s.default.prompt(o).then((function(e){if(e.entrypoint===""){throw new Error("Error! No entrypoint given")}if(!t.default.existsSync(i.default.join(process.cwd(),e.entrypoint))){throw new Error("Error! Entrypoint does not exist")}var r={client:{entryPoint:e.entrypoint}};t.default.writeFileSync(i.default.join(process.cwd(),"prerendered.json"),JSON.stringify(r,null,2));console.log("Created prerendered.json")}))}));u.program.command("build").description("Build prerendered").action((function(e,r){if(!t.default.existsSync(i.default.join(process.cwd(),"prerendered.json"))){throw new Error("Error! prerendered.json not found. Please run `prerendered init`")}console.log("Bunding app");var o=i.default.join(process.cwd(),"prerendered.json");console.log("prerendered.json location: %s",o);var n=JSON.parse(t.default.readFileSync(o).toString("utf-8"));var s=l.createConfig(n.client.entryPoint,u.program.debug);a.default(s,(function(e,r){if(e!==null||r.hasErrors()){if(e!==null&&e.message){console.error(e.message)}if(r.hasErrors()){var o=r.toJson();o.errors.map(console.error)}throw new Error("Error! Webpack: Failed to compile")}var n=r.toJson();if(r.hasErrors()){n.errors.map(console.error)}if(r.hasWarnings()){n.warnings.map(console.warn)}console.log("Webpack: Done!")}))}));u.program.parse(process.argv)},function(e,r){e.exports=require("fs")},function(e,r){e.exports=require("inquirer")},function(e,r){e.exports=require("webpack")},function(e,r){e.exports=require("commander")},function(e,r,o){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:true});r.createConfig=void 0;var t=o(0);var i=n(o(7));var s=o(8);var a=n(o(9));r.createConfig=function(e,r){if(r===void 0){r=false}var o="static";var n=t.resolve(__dirname,"tsconfig.prr.json");var u={mode:"production",entry:t.resolve(process.cwd(),e),output:{path:t.resolve(process.cwd(),".prerendered",o),filename:"[name].[contenthash].js",chunkFilename:"[id]-[chunkhash].js"},module:{rules:[{test:/\.tsx?$/,exclude:[/node_modules/],include:[t.resolve(process.cwd(),t.dirname(e))],loader:"ts-loader",options:{configFile:n}}]},resolve:{extensions:[".js",".jsx",".ts",".tsx"]},devtool:"source-map",target:"web",optimization:{minimize:true,minimizer:[new i.default({parallel:true,terserOptions:{compress:false,ecma:6,mangle:true},sourceMap:true,test:/\.js(\?.*)?$/i})]},node:{net:"empty",fs:"empty"},plugins:[new s.CleanWebpackPlugin,new a.default({publicPath:o+"/",fileName:t.resolve(process.cwd(),".prerendered","manifest.json")})]};if(r){console.log("tsconfig.prr.json: %s",n);console.log("Path prefix: %s",o);console.log("Webpack configuration: %s",JSON.stringify(u,null,2))}return u}},function(e,r){e.exports=require("terser-webpack-plugin")},function(e,r){e.exports=require("clean-webpack-plugin")},function(e,r){e.exports=require("webpack-manifest-plugin")}])}));
//# sourceMappingURL=cli.js.map